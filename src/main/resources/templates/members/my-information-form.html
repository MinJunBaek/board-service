<!-- my-information-form.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous"/>
    <title>내 정보</title>
  </head>
  <body>

    <div th:replace="~{fragments/navbar :: navbar}"></div>

    <div class="container mt-5" style="max-width: 600px;">
      <h2 class="mb-4 text-center">내 정보</h2>

      <!-- 성공 메시지 -->
      <div class="alert alert-success"
           th:if="${successMessage}"
           th:text="${successMessage}">
      </div>

      <!-- 내 정보 + 수정 폼 -->
      <form th:action="@{/members/me}" th:object="${editForm}" method="post" novalidate>

        <!-- 글로벌 에러 -->
        <div class="alert alert-danger" th:if="${#fields.hasGlobalErrors()}">
          <p th:each="err : ${#fields.globalErrors()}" th:text="${err}"></p>
        </div>

        <!-- 이메일: 읽기 전용 -->
        <div class="mb-3">
          <label class="form-label">이메일</label>
          <input type="text"
                 class="form-control"
                 th:value="${member.email}"
                 readonly />
        </div>

        <!-- 권한: 읽기 전용 (필요하면) -->
        <div class="mb-3">
          <label class="form-label">권한</label>
          <input type="text"
                 class="form-control"
                 th:value="${member.memberRole}"
                 readonly />
        </div>

        <!-- 현재 비밀번호 (필수) -->
        <div class="mb-3">
          <label for="password" class="form-label">현재 비밀번호(수정시 필수)</label>
          <input type="password"
                 id="password"
                 class="form-control"
                 th:field="*{password}" />
          <div class="text-danger" th:errors="*{password}"></div>
        </div>

        <!-- 새 비밀번호 -->
        <div class="mb-3">
          <label for="changePassword" class="form-label">새 비밀번호 (선택)</label>
          <input type="password"
                 id="changePassword"
                 class="form-control"
                 th:field="*{changePassword}" />
          <div class="text-danger" th:errors="*{newPasswordDifferentFromCurrent}"></div>
        </div>

        <!-- 새 비밀번호 확인 -->
        <div class="mb-3">
          <label for="confirmPasswordChange" class="form-label">새 비밀번호 확인</label>
          <input type="password"
                 id="confirmPasswordChange"
                 class="form-control"
                 th:field="*{confirmPasswordChange}" />
          <div class="text-danger" th:errors="*{passwordConfirmMatched}"></div>
        </div>

        <!-- 이름 수정 -->
        <div class="mb-3">
          <label for="name" class="form-label">이름</label>
          <input type="text"
                 id="name"
                 class="form-control"
                 th:field="*{name}"
                 th:placeholder="${member.name}" />
          <div class="text-danger" th:errors="*{name}"></div>
        </div>

        <!-- 주소 수정 -->
        <div class="mb-3">
          <label for="address" class="form-label">주소</label>
          <input type="text"
                 id="address"
                 class="form-control"
                 th:field="*{address}"
                 th:placeholder="${member.address}" />
          <div class="text-danger" th:errors="*{address}"></div>
        </div>

        <!-- 오른쪽 아래 수정 버튼 -->
        <div class="d-flex justify-content-end">
          <button type="submit" class="btn btn-primary">
            수정
          </button>
        </div>
      </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
            crossorigin="anonymous"
    ></script>
  </body>
</html>
