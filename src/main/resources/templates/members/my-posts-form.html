<!-- my-posts-form.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
        crossorigin="anonymous"
    />
    <title>내가 작성한 게시글</title>
  </head>
  <body>
    <!-- 상단 네비게이션 -->
    <div th:replace="~{fragments/navbar :: navbar}"></div>

    <div class="container mt-5">
      <div class="row">
        <!-- 왼쪽 네비게이션 (fragment 사용) -->
        <div class="col-md-3 mb-4">
          <!-- INFO 페이지이므로 activeMenu='INFO' 전달 -->
          <div th:replace="~{fragments/member-sidebar :: memberSidebar('POSTS')}"></div>
        </div>

        <!-- 오른쪽 내용 영역 -->
        <div class="col-md-9">
          <div>
            <h2>내가 작성한 게시글</h2>
          </div>

          <!-- 게시글이 없는 경우 -->
          <div class="alert alert-info" th:if="${#lists.isEmpty(posts)}">
            아직 작성된 게시글이 없습니다.
          </div>

          <!-- 게시글 목록 테이블 -->
          <table class="table table-hover" th:if="${!#lists.isEmpty(posts)}">
            <thead class="table-light">
            <tr>
              <th style="width: 80px;">번호</th>
              <th>제목</th>
              <th style="width: 100px;">작성자</th>
              <th style="width: 100px;">좋아요</th>
              <th style="width: 100px;">조회수</th>
            </tr>
            </thead>

            <tbody>
            <tr th:each="post : ${posts}">
              <!-- 번호 -->
              <td th:text="${post.id}">1</td>

              <!-- 제목 + (오른쪽에) 수정/삭제 버튼 -->
              <td>
                <div class="d-flex justify-content-between align-items-center">
                  <!-- 제목 링크 -->
                  <a th:href="@{|/posts/${post.id}/posts-form|}"
                     th:text="${post.title}">
                    게시글 제목
                  </a>

                  <!-- 🔹 로그인 + 작성자 본인일 때만 버튼 노출 -->
                  <div th:if="${loggedIn and memberPrincipalId == post.memberId}"
                       class="d-inline-flex gap-1 ms-2">

                    <!-- 수정 버튼: 삭제와 같은 형태의 button -->
                    <form th:action="@{|/posts/${post.id}/posts-edit-form|}" method="get"
                          class="m-0 d-inline-block">
                      <button type="submit" class="btn btn-outline-primary btn-sm">
                        수정
                      </button>
                    </form>

                    <!-- 삭제 버튼 -->
                    <form th:action="@{|/posts/${post.id}|}" method="post"
                          class="m-0 d-inline-block"
                          onsubmit="return confirm('정말 삭제하시겠습니까?');">
                      <input type="hidden" name="_method" value="delete"/>
                      <button type="submit" class="btn btn-outline-danger btn-sm">
                        삭제
                      </button>
                    </form>
                  </div>
                </div>
              </td>
              <td>
                <div th:text="${post.memberName}">
                  작성자
                </div>
              </td>

              <!-- 좋아요 / 조회수 -->
              <td th:text="${post.likeCount}">0</td>
              <td th:text="${post.viewCount}">0</td>
            </tr>
            </tbody>
          </table>
        </div>
        <!-- /오른쪽 내용 -->
      </div>
    </div>

    <script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"
    ></script>
  </body>
</html>
