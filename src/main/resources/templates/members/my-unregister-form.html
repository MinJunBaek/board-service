<!-- my-unregister-form.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
        crossorigin="anonymous"
    />
    <title>회원 탈퇴</title>
  </head>
  <body>
    <!-- 상단 네비게이션 -->
    <div th:replace="~{fragments/navbar :: navbar}"></div>

    <div class="container mt-5">
      <div class="row">
        <!-- 왼쪽 네비게이션 -->
        <div class="col-md-3 mb-4">
          <div th:replace="~{fragments/member-sidebar :: memberSidebar('WITHDRAW')}"></div>
        </div>

        <!-- 오른쪽 내용 영역 -->
        <div class="col-md-9">
          <h2 class="mb-4">회원 탈퇴</h2>

          <!-- 약관 영역 -->
          <div class="card mb-4">
            <div class="card-header">
              회원 탈퇴 약관
            </div>
            <div class="card-body" style="max-height: 200px; overflow-y: auto;">
              <!-- 여기에 실제 약관 내용을 채우면 됨 -->
              <p>
                1. 회원 탈퇴 시 작성한 게시글 및 댓글은 삭제되지 않을 수 있습니다. (정책에 따라 결정)<br />
                2. 탈퇴 후에는 동일 이메일로 재가입 시 기존 데이터는 복구되지 않습니다.<br />
                3. 기타 자세한 내용은 서비스 이용약관을 참고해 주세요.<br />
              </p>
            </div>
          </div>

          <!-- 회원 탈퇴 폼 -->
          <form th:action="@{/members/me/withdraw}"
                th:object="${unregister}"
                method="post">

            <!-- CSRF -->
            <input type="hidden"
                   th:name="${_csrf.parameterName}"
                   th:value="${_csrf.token}" />

            <div class="mb-3">
              <label class="form-label">이름</label>
              <input type="text" class="form-control"
                     th:value="${memberPrincipalName}" disabled />
            </div>

            <div class="mb-3">
              <label class="form-label">이메일</label>
              <input type="email" class="form-control"
                     th:value="${memberPrincipalEmail}" disabled />
            </div>

            <div class="mb-3">
              <label for="password" class="form-label">비밀번호 확인</label>
              <input type="password"
                     id="password"
                     th:field="*{password}"
                     class="form-control" />

              <!-- 필드 에러 출력 -->
              <div class="text-danger" th:if="${#fields.hasErrors('password')}"
                   th:errors="*{password}"></div>
            </div>

            <!-- 글로벌 에러 (비즈니스 에러 등) -->
            <div class="alert alert-danger"
                 th:if="${#fields.hasGlobalErrors()}"
                 th:each="err : ${#fields.globalErrors()}"
                 th:text="${err}"></div>

            <div class="d-flex justify-content-end">
              <button type="submit" class="btn btn-danger">회원 탈퇴하기</button>
            </div>
          </form>

        </div>
      </div>
    </div>

    <script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"
    ></script>
  </body>
</html>
